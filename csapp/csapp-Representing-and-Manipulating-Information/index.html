<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>CS:APP - Representing and Manipulating Information | Shawn Hsu</title>
<meta name="description" content="CS:APP 的學習筆記">


  <meta name="author" content="Shawn Hsu">
  
  <meta property="article:author" content="Shawn Hsu">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Shawn Hsu">
<meta property="og:title" content="CS:APP - Representing and Manipulating Information">
<meta property="og:url" content="https://ambersuncreates.com/csapp/csapp-Representing-and-Manipulating-Information/">


  <meta property="og:description" content="CS:APP 的學習筆記">


<meta property="og:image" content="/assets/img/og/csapp-Representing-and-Manipulating-Information.png">




  <meta property="article:published_time" content="2021-08-14T00:00:00+08:00">



  <meta property="article:modified_time" content="2024-02-28T00:54:43+08:00">



  

  


<link rel="canonical" href="https://ambersuncreates.com/csapp/csapp-Representing-and-Manipulating-Information/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Shawn Hsu",
      "url": "https://ambersuncreates.com/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Shawn Hsu Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3411784157543420"
     crossorigin="anonymous"></script>

<!-- google ads -->
<script async src="https://fundingchoicesmessages.google.com/i/pub-3411784157543420?ers=1" nonce="DTHVC27nOex6L5olJXhYMg"></script><script nonce="DTHVC27nOex6L5olJXhYMg">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
<script>(function(){'use strict';function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
  function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function k(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
  function ea(a){return a.raw=a}function m(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function fa(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var ha="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},n;
  if("function"==typeof Object.setPrototypeOf)n=Object.setPrototypeOf;else{var q;a:{var ia={a:!0},ja={};try{ja.__proto__=ia;q=ja.a;break a}catch(a){}q=!1}n=q?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ka=n;
  function r(a,b){a.prototype=ha(b.prototype);a.prototype.constructor=a;if(ka)ka(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.A=b.prototype}function la(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}k("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991});
  k("Number.isFinite",function(a){return a?a:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}});k("Number.isInteger",function(a){return a?a:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}});k("Number.isSafeInteger",function(a){return a?a:function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER}});
  k("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});k("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}});k("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=d[c];if(f===b||Object.is(f,b))return!0}return!1}});
  k("String.prototype.includes",function(a){return a?a:function(b,c){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(b,c||0)}});/*
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */
  var t=this||self;function v(a){return a};var w,x;a:{for(var ma=["CLOSURE_FLAGS"],y=t,z=0;z<ma.length;z++)if(y=y[ma[z]],null==y){x=null;break a}x=y}var na=x&&x[610401301];w=null!=na?na:!1;var A,oa=t.navigator;A=oa?oa.userAgentData||null:null;function B(a){return w?A?A.brands.some(function(b){return(b=b.brand)&&-1!=b.indexOf(a)}):!1:!1}function C(a){var b;a:{if(b=t.navigator)if(b=b.userAgent)break a;b=""}return-1!=b.indexOf(a)};function D(){return w?!!A&&0<A.brands.length:!1}function E(){return D()?B("Chromium"):(C("Chrome")||C("CriOS"))&&!(D()?0:C("Edge"))||C("Silk")};var pa=D()?!1:C("Trident")||C("MSIE");!C("Android")||E();E();C("Safari")&&(E()||(D()?0:C("Coast"))||(D()?0:C("Opera"))||(D()?0:C("Edge"))||(D()?B("Microsoft Edge"):C("Edg/"))||D()&&B("Opera"));var qa={},F=null;var ra="undefined"!==typeof Uint8Array,sa=!pa&&"function"===typeof btoa;function G(){return"function"===typeof BigInt};var H=0,I=0;function ta(a){var b=0>a;a=Math.abs(a);var c=a>>>0;a=Math.floor((a-c)/4294967296);b&&(c=m(ua(c,a)),b=c.next().value,a=c.next().value,c=b);H=c>>>0;I=a>>>0}function va(a,b){b>>>=0;a>>>=0;if(2097151>=b)var c=""+(4294967296*b+a);else G()?c=""+(BigInt(b)<<BigInt(32)|BigInt(a)):(c=(a>>>24|b<<8)&16777215,b=b>>16&65535,a=(a&16777215)+6777216*c+6710656*b,c+=8147497*b,b*=2,1E7<=a&&(c+=Math.floor(a/1E7),a%=1E7),1E7<=c&&(b+=Math.floor(c/1E7),c%=1E7),c=b+wa(c)+wa(a));return c}
  function wa(a){a=String(a);return"0000000".slice(a.length)+a}function ua(a,b){b=~b;a?a=~a+1:b+=1;return[a,b]};var J;J="function"===typeof Symbol&&"symbol"===typeof Symbol()?Symbol():void 0;var xa=J?function(a,b){a[J]|=b}:function(a,b){void 0!==a.g?a.g|=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}})},K=J?function(a){return a[J]|0}:function(a){return a.g|0},L=J?function(a){return a[J]}:function(a){return a.g},M=J?function(a,b){a[J]=b;return a}:function(a,b){void 0!==a.g?a.g=b:Object.defineProperties(a,{g:{value:b,configurable:!0,writable:!0,enumerable:!1}});return a};function ya(a,b){M(b,(a|0)&-14591)}function za(a,b){M(b,(a|34)&-14557)}
  function Aa(a){a=a>>14&1023;return 0===a?536870912:a};var N={},Ba={};function Ca(a){return!(!a||"object"!==typeof a||a.g!==Ba)}function Da(a){return null!==a&&"object"===typeof a&&!Array.isArray(a)&&a.constructor===Object}function P(a,b,c){if(!Array.isArray(a)||a.length)return!1;var d=K(a);if(d&1)return!0;if(!(b&&(Array.isArray(b)?b.includes(c):b.has(c))))return!1;M(a,d|1);return!0}Object.freeze(new function(){});Object.freeze(new function(){});var Ea=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;var Q;function Fa(a,b){Q=b;a=new a(b);Q=void 0;return a}
  function R(a,b,c){null==a&&(a=Q);Q=void 0;if(null==a){var d=96;c?(a=[c],d|=512):a=[];b&&(d=d&-16760833|(b&1023)<<14)}else{if(!Array.isArray(a))throw Error();d=K(a);if(d&64)return a;d|=64;if(c&&(d|=512,c!==a[0]))throw Error();a:{c=a;var e=c.length;if(e){var f=e-1;if(Da(c[f])){d|=256;b=f-(+!!(d&512)-1);if(1024<=b)throw Error();d=d&-16760833|(b&1023)<<14;break a}}if(b){b=Math.max(b,e-(+!!(d&512)-1));if(1024<b)throw Error();d=d&-16760833|(b&1023)<<14}}}M(a,d);return a};function Ga(a){switch(typeof a){case "number":return isFinite(a)?a:String(a);case "boolean":return a?1:0;case "object":if(a)if(Array.isArray(a)){if(P(a,void 0,0))return}else if(ra&&null!=a&&a instanceof Uint8Array){if(sa){for(var b="",c=0,d=a.length-10240;c<d;)b+=String.fromCharCode.apply(null,a.subarray(c,c+=10240));b+=String.fromCharCode.apply(null,c?a.subarray(c):a);a=btoa(b)}else{void 0===b&&(b=0);if(!F){F={};c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");d=["+/=",
  "+/","-_=","-_.","-_"];for(var e=0;5>e;e++){var f=c.concat(d[e].split(""));qa[e]=f;for(var g=0;g<f.length;g++){var h=f[g];void 0===F[h]&&(F[h]=g)}}}b=qa[b];c=Array(Math.floor(a.length/3));d=b[64]||"";for(e=f=0;f<a.length-2;f+=3){var l=a[f],p=a[f+1];h=a[f+2];g=b[l>>2];l=b[(l&3)<<4|p>>4];p=b[(p&15)<<2|h>>6];h=b[h&63];c[e++]=g+l+p+h}g=0;h=d;switch(a.length-f){case 2:g=a[f+1],h=b[(g&15)<<2]||d;case 1:a=a[f],c[e]=b[a>>2]+b[(a&3)<<4|g>>4]+h+d}a=c.join("")}return a}}return a};function Ha(a,b,c){a=Array.prototype.slice.call(a);var d=a.length,e=b&256?a[d-1]:void 0;d+=e?-1:0;for(b=b&512?1:0;b<d;b++)a[b]=c(a[b]);if(e){b=a[b]={};for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(b[f]=c(e[f]))}return a}function Ia(a,b,c,d,e){if(null!=a){if(Array.isArray(a))a=P(a,void 0,0)?void 0:e&&K(a)&2?a:Ja(a,b,c,void 0!==d,e);else if(Da(a)){var f={},g;for(g in a)Object.prototype.hasOwnProperty.call(a,g)&&(f[g]=Ia(a[g],b,c,d,e));a=f}else a=b(a,d);return a}}
  function Ja(a,b,c,d,e){var f=d||c?K(a):0;d=d?!!(f&32):void 0;a=Array.prototype.slice.call(a);for(var g=0;g<a.length;g++)a[g]=Ia(a[g],b,c,d,e);c&&c(f,a);return a}function Ka(a){return a.s===N?a.toJSON():Ga(a)};function La(a,b,c){c=void 0===c?za:c;if(null!=a){if(ra&&a instanceof Uint8Array)return b?a:new Uint8Array(a);if(Array.isArray(a)){var d=K(a);if(d&2)return a;b&&(b=0===d||!!(d&32)&&!(d&64||!(d&16)));return b?M(a,(d|34)&-12293):Ja(a,La,d&4?za:c,!0,!0)}a.s===N&&(c=a.h,d=L(c),a=d&2?a:Fa(a.constructor,Ma(c,d,!0)));return a}}function Ma(a,b,c){var d=c||b&2?za:ya,e=!!(b&32);a=Ha(a,b,function(f){return La(f,e,d)});xa(a,32|(c?2:0));return a};function Na(a,b){a=a.h;return Oa(a,L(a),b)}function Oa(a,b,c,d){if(-1===c)return null;if(c>=Aa(b)){if(b&256)return a[a.length-1][c]}else{var e=a.length;if(d&&b&256&&(d=a[e-1][c],null!=d))return d;b=c+(+!!(b&512)-1);if(b<e)return a[b]}}function Pa(a,b,c,d,e){var f=Aa(b);if(c>=f||e){var g=b;if(b&256)e=a[a.length-1];else{if(null==d)return;e=a[f+(+!!(b&512)-1)]={};g|=256}e[c]=d;c<f&&(a[c+(+!!(b&512)-1)]=void 0);g!==b&&M(a,g)}else a[c+(+!!(b&512)-1)]=d,b&256&&(a=a[a.length-1],c in a&&delete a[c])}
  function Qa(a,b){var c=Ra;var d=void 0===d?!1:d;var e=a.h;var f=L(e),g=Oa(e,f,b,d);if(null!=g&&"object"===typeof g&&g.s===N)c=g;else if(Array.isArray(g)){var h=K(g),l=h;0===l&&(l|=f&32);l|=f&2;l!==h&&M(g,l);c=new c(g)}else c=void 0;c!==g&&null!=c&&Pa(e,f,b,c,d);e=c;if(null==e)return e;a=a.h;f=L(a);f&2||(g=e,c=g.h,h=L(c),g=h&2?Fa(g.constructor,Ma(c,h,!1)):g,g!==e&&(e=g,Pa(a,f,b,e,d)));return e}function Sa(a,b){a=Na(a,b);return null==a||"string"===typeof a?a:void 0}
  function Ta(a,b){var c=void 0===c?0:c;a=Na(a,b);if(null!=a)if(b=typeof a,"number"===b?Number.isFinite(a):"string"!==b?0:Ea.test(a))if("number"===typeof a){if(a=Math.trunc(a),!Number.isSafeInteger(a)){ta(a);b=H;var d=I;if(a=d&2147483648)b=~b+1>>>0,d=~d>>>0,0==b&&(d=d+1>>>0);b=4294967296*d+(b>>>0);a=a?-b:b}}else if(b=Math.trunc(Number(a)),Number.isSafeInteger(b))a=String(b);else{if(b=a.indexOf("."),-1!==b&&(a=a.substring(0,b)),!("-"===a[0]?20>a.length||20===a.length&&-922337<Number(a.substring(0,7)):
  19>a.length||19===a.length&&922337>Number(a.substring(0,6)))){if(16>a.length)ta(Number(a));else if(G())a=BigInt(a),H=Number(a&BigInt(4294967295))>>>0,I=Number(a>>BigInt(32)&BigInt(4294967295));else{b=+("-"===a[0]);I=H=0;d=a.length;for(var e=b,f=(d-b)%6+b;f<=d;e=f,f+=6)e=Number(a.slice(e,f)),I*=1E6,H=1E6*H+e,4294967296<=H&&(I+=Math.trunc(H/4294967296),I>>>=0,H>>>=0);b&&(b=m(ua(H,I)),a=b.next().value,b=b.next().value,H=a,I=b)}a=H;b=I;b&2147483648?G()?a=""+(BigInt(b|0)<<BigInt(32)|BigInt(a>>>0)):(b=
  m(ua(a,b)),a=b.next().value,b=b.next().value,a="-"+va(a,b)):a=va(a,b)}}else a=void 0;return null!=a?a:c}function S(a,b){a=Sa(a,b);return null!=a?a:""};function T(a,b,c){this.h=R(a,b,c)}T.prototype.toJSON=function(){return Ua(this,Ja(this.h,Ka,void 0,void 0,!1),!0)};T.prototype.s=N;T.prototype.toString=function(){return Ua(this,this.h,!1).toString()};
  function Ua(a,b,c){var d=a.constructor.v,e=L(c?a.h:b);a=b.length;if(!a)return b;var f;if(Da(c=b[a-1])){a:{var g=c;var h={},l=!1,p;for(p in g)if(Object.prototype.hasOwnProperty.call(g,p)){var u=g[p];if(Array.isArray(u)){var jb=u;if(P(u,d,+p)||Ca(u)&&0===u.size)u=null;u!=jb&&(l=!0)}null!=u?h[p]=u:l=!0}if(l){for(var O in h){g=h;break a}g=null}}g!=c&&(f=!0);a--}for(p=+!!(e&512)-1;0<a;a--){O=a-1;c=b[O];O-=p;if(!(null==c||P(c,d,O)||Ca(c)&&0===c.size))break;var kb=!0}if(!f&&!kb)return b;b=Array.prototype.slice.call(b,
  0,a);g&&b.push(g);return b};function Va(a){return function(b){if(null==b||""==b)b=new a;else{b=JSON.parse(b);if(!Array.isArray(b))throw Error(void 0);xa(b,32);b=Fa(a,b)}return b}};function Wa(a){this.h=R(a)}r(Wa,T);var Xa=Va(Wa);var U;function V(a){this.g=a}V.prototype.toString=function(){return this.g+""};var Ya={};function Za(a){if(void 0===U){var b=null;var c=t.trustedTypes;if(c&&c.createPolicy){try{b=c.createPolicy("goog#html",{createHTML:v,createScript:v,createScriptURL:v})}catch(d){t.console&&t.console.error(d.message)}U=b}else U=b}a=(b=U)?b.createScriptURL(a):a;return new V(a,Ya)};function $a(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};function ab(a,b){b=String(b);"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)}function bb(a){this.g=a||t.document||document};/*
  
   SPDX-License-Identifier: Apache-2.0
  */
  function cb(a,b){a.src=b instanceof V&&b.constructor===V?b.g:"type_error:TrustedResourceUrl";var c,d;(c=(b=null==(d=(c=(a.ownerDocument&&a.ownerDocument.defaultView||window).document).querySelector)?void 0:d.call(c,"script[nonce]"))?b.nonce||b.getAttribute("nonce")||"":"")&&a.setAttribute("nonce",c)};function db(a){a=void 0===a?document:a;return a.createElement("script")};function eb(a,b,c,d,e,f){try{var g=a.g,h=db(g);h.async=!0;cb(h,b);g.head.appendChild(h);h.addEventListener("load",function(){e();d&&g.head.removeChild(h)});h.addEventListener("error",function(){0<c?eb(a,b,c-1,d,e,f):(d&&g.head.removeChild(h),f())})}catch(l){f()}};var fb=t.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),gb=t.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),hb=t.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu");function ib(a,b,c){this.i=a;this.u=b;this.o=c;this.g=null;this.j=[];this.m=!1;this.l=new bb(this.i)}
  function lb(a){if(a.i.body&&!a.m){var b=function(){mb(a);t.setTimeout(function(){nb(a,3)},50)};eb(a.l,a.u,2,!0,function(){t[a.o]||b()},b);a.m=!0}}
  function mb(a){for(var b=W(1,5),c=0;c<b;c++){var d=X(a);a.i.body.appendChild(d);a.j.push(d)}b=X(a);b.style.bottom="0";b.style.left="0";b.style.position="fixed";b.style.width=W(100,110).toString()+"%";b.style.zIndex=W(2147483544,2147483644).toString();b.style.backgroundColor=ob(249,259,242,252,219,229);b.style.boxShadow="0 0 12px #888";b.style.color=ob(0,10,0,10,0,10);b.style.display="flex";b.style.justifyContent="center";b.style.fontFamily="Roboto, Arial";c=X(a);c.style.width=W(80,85).toString()+
  "%";c.style.maxWidth=W(750,775).toString()+"px";c.style.margin="24px";c.style.display="flex";c.style.alignItems="flex-start";c.style.justifyContent="center";d=ab(a.l.g,"IMG");d.className=$a();d.src=fb;d.alt="Warning icon";d.style.height="24px";d.style.width="24px";d.style.paddingRight="16px";var e=X(a),f=X(a);f.style.fontWeight="bold";f.textContent=gb;var g=X(a);g.textContent=hb;Y(a,e,f);Y(a,e,g);Y(a,c,d);Y(a,c,e);Y(a,b,c);a.g=b;a.i.body.appendChild(a.g);b=W(1,5);for(c=0;c<b;c++)d=X(a),a.i.body.appendChild(d),
  a.j.push(d)}function Y(a,b,c){for(var d=W(1,5),e=0;e<d;e++){var f=X(a);b.appendChild(f)}b.appendChild(c);c=W(1,5);for(d=0;d<c;d++)e=X(a),b.appendChild(e)}function W(a,b){return Math.floor(a+Math.random()*(b-a))}function ob(a,b,c,d,e,f){return"rgb("+W(Math.max(a,0),Math.min(b,255)).toString()+","+W(Math.max(c,0),Math.min(d,255)).toString()+","+W(Math.max(e,0),Math.min(f,255)).toString()+")"}function X(a){a=ab(a.l.g,"DIV");a.className=$a();return a}
  function nb(a,b){0>=b||null!=a.g&&0!==a.g.offsetHeight&&0!==a.g.offsetWidth||(pb(a),mb(a),t.setTimeout(function(){nb(a,b-1)},50))}function pb(a){for(var b=m(a.j),c=b.next();!c.done;c=b.next())(c=c.value)&&c.parentNode&&c.parentNode.removeChild(c);a.j=[];(b=a.g)&&b.parentNode&&b.parentNode.removeChild(b);a.g=null};function qb(a,b,c,d,e){function f(l){document.body?g(document.body):0<l?t.setTimeout(function(){f(l-1)},e):b()}function g(l){l.appendChild(h);t.setTimeout(function(){h?(0!==h.offsetHeight&&0!==h.offsetWidth?b():a(),h.parentNode&&h.parentNode.removeChild(h)):a()},d)}var h=rb(c);f(3)}function rb(a){var b=document.createElement("div");b.className=a;b.style.width="1px";b.style.height="1px";b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";b.style.zIndex="-10000";return b};function Ra(a){this.h=R(a)}r(Ra,T);function sb(a){this.h=R(a)}r(sb,T);var tb=Va(sb);function ub(a){var b=la.apply(1,arguments);if(0===b.length)return Za(a[0]);for(var c=a[0],d=0;d<b.length;d++)c+=encodeURIComponent(b[d])+a[d+1];return Za(c)};function vb(a){if(!a)return null;a=Sa(a,4);var b;null===a||void 0===a?b=null:b=Za(a);return b};var wb=ea([""]),xb=ea([""]);function yb(a,b){this.m=a;this.o=new bb(a.document);this.g=b;this.j=S(this.g,1);this.u=vb(Qa(this.g,2))||ub(wb);this.i=!1;b=vb(Qa(this.g,13))||ub(xb);this.l=new ib(a.document,b,S(this.g,12))}yb.prototype.start=function(){zb(this)};
  function zb(a){Ab(a);eb(a.o,a.u,3,!1,function(){a:{var b=a.j;var c=t.btoa(b);if(c=t[c]){try{var d=Xa(t.atob(c))}catch(e){b=!1;break a}b=b===Sa(d,1)}else b=!1}b?Z(a,S(a.g,14)):(Z(a,S(a.g,8)),lb(a.l))},function(){qb(function(){Z(a,S(a.g,7));lb(a.l)},function(){return Z(a,S(a.g,6))},S(a.g,9),Ta(a.g,10),Ta(a.g,11))})}function Z(a,b){a.i||(a.i=!0,a=new a.m.XMLHttpRequest,a.open("GET",b,!0),a.send())}function Ab(a){var b=t.btoa(a.j);a.m[b]&&Z(a,S(a.g,5))};(function(a,b){t[a]=function(){var c=la.apply(0,arguments);t[a]=function(){};b.call.apply(b,[null].concat(c instanceof Array?c:fa(m(c))))}})("__h82AlnkH6D91__",function(a){"function"===typeof window.atob&&(new yb(window,tb(window.atob(a)))).start()});}).call(this);
  
  window.__h82AlnkH6D91__("WyJwdWItMzQxMTc4NDE1NzU0MzQyMCIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi0zNDExNzg0MTU3NTQzNDIwIl0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hXcFo2SEZhZ2tXV3BBeDkyVm5FUm1HelA4Sng3NDBjbG82QTd1U1BzMjMtb1J6aTl0R2tJZC0ySTZkbU9kVExldXJ5VU5pdDJmWVl6cVN3ZXFSaHFtT1d3XHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFVub2h4aTRwNDRvRHN5UjNjSzBTTlVWdlhldmoySHp3dHBPMk52dlF4SXpPc1RuT1E4ZXV1Qzc4UExTRzROMFplT28xRWF6MG5hYjVHNElnMGJ5M1RqTkFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFU0c2VpaDRuem1aQ2VKc0s0OUpFdHNBT3ZIZkNGaE9yMXFDN3N5bzRSaHBmamQzay02OGlaakhUT0UybWlxTEx6SnpZYUFPZHhTYWVRMC1LMGRZc0VabWdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdROU1sNExITHNkMVg0RzJualpOUXBhVE1GVzVTU2RUb0hUVF9oU1F6OVI3cm1RSVZsR3kzOFgyMng0dDZSVHJLdTVRaUlrdkl0ZFd2TFJ1Mnl2SEVaTXdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUTTBNVEUzT0RReE5UYzFORE0wTWpBXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi0zNDExNzg0MTU3NTQzNDIwLmpzP3VzcXBcdTAwM2RDQkkiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4V3YwN0dzbGhnVi1oUV85a0wzV0FhN0hmUXo3dXhKTWFBLUtHQ3VMOUhrWmRVWEFneHNmcVdIYUJrZlhBZkF1TUdyM2hFTmVMeVhZZDItS25ublNQODdwZ1x1MDAzZFx1MDAzZCJd");</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Shawn Hsu
          <span class="site-subtitle">Shawn Hsu's personal study blog | Software Engineer | Backend | Cloud Native | Blockchain</span>
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#csapp" itemprop="item"><span itemprop="name">Csapp</span></a>
          <meta itemprop="position" content="2">
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">CS:APP - Representing and Manipulating Information</li>
      
    
  </ol>
</nav>

  


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const sidebarNav = document.querySelector("nav.toc");
    if (!sidebarNav) {
      return;
    }

    // Find the actual scrollable container
    let scrollContainer = null;

    // Check if the nav itself is scrollable
    if (sidebarNav.scrollHeight > sidebarNav.offsetHeight) {
      scrollContainer = sidebarNav;
    } else {
      // Look for scrollable children
      const tocMenu = sidebarNav.querySelector(".toc__menu");
      if (tocMenu && tocMenu.scrollHeight > tocMenu.offsetHeight) {
        scrollContainer = tocMenu;
      } else {
        // Look for any scrollable child
        const children = sidebarNav.children;
        for (let child of children) {
          if (child.scrollHeight > child.offsetHeight) {
            scrollContainer = child;
            break;
          }
        }
      }
    }

    if (!scrollContainer) {
      return;
    }

    let isUserScrolling = false;
    let autoScrollEnabled = true;
    let scrollTimeout;
    let pageScrollTimeout;
    let periodicCheckInterval;

    // Function to check if element is visible in container
    const isElementVisible = (element) => {
      const containerTop = scrollContainer.scrollTop;
      const containerHeight = scrollContainer.offsetHeight;
      const elementTop = element.offsetTop;
      const elementHeight = element.offsetHeight;

      const isVisible =
        elementTop >= containerTop &&
        elementTop + elementHeight <= containerTop + containerHeight;

      return isVisible;
    };

    // Function to find the current active heading based on scroll position
    const findCurrentActiveHeading = () => {
      const headings = document.querySelectorAll(
        "h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]"
      );
      const scrollY = window.scrollY;
      const offset = 100; // Offset to trigger activation

      let currentHeading = null;

      // Find the heading that's currently at the top of the viewport
      for (let i = 0; i < headings.length; i++) {
        const heading = headings[i];
        const headingTop = heading.offsetTop;

        if (headingTop <= scrollY + offset) {
          currentHeading = heading;
        } else {
          break;
        }
      }

      return currentHeading;
    };

    // Function to find the TOC element that corresponds to a heading
    const findTocElementForHeading = (heading) => {
      if (!heading || !heading.id) return null;

      const tocLinks = document.querySelectorAll("nav.toc a");
      for (const link of tocLinks) {
        if (link.getAttribute("href") === `#${heading.id}`) {
          return link.closest("li");
        }
      }
      return null;
    };

    // Function to scroll TOC to show active element
    const scrollTocToActive = () => {
      // Don't auto-scroll if user is manually scrolling or auto-scroll is disabled
      if (isUserScrolling || !autoScrollEnabled) {
        return;
      }

      // Always use scroll position to find the current heading
      const currentHeading = findCurrentActiveHeading();
      if (!currentHeading) {
        return;
      }

      const activeElement = findTocElementForHeading(currentHeading);
      if (!activeElement) {
        return;
      }

      // Check if active element is visible
      if (!isElementVisible(activeElement)) {
        // Get the current scroll position and container dimensions
        const currentScrollTop = scrollContainer.scrollTop;
        const containerHeight = scrollContainer.offsetHeight;
        const elementTop = activeElement.offsetTop;
        const elementHeight = activeElement.offsetHeight;

        // Calculate the position to center the active element in the visible area
        const targetScrollTop =
          elementTop - containerHeight / 2 + elementHeight / 2;

        // Ensure we don't scroll beyond the bounds
        const maxScrollTop = scrollContainer.scrollHeight - containerHeight;
        const finalScrollTop = Math.max(
          0,
          Math.min(targetScrollTop, maxScrollTop)
        );

        // Scroll to the target position
        scrollContainer.scrollTo({
          top: finalScrollTop,
          behavior: "smooth",
        });
      }
    };

    // Function to enable auto-scroll
    const enableAutoScroll = () => {
      if (!autoScrollEnabled) {
        autoScrollEnabled = true;
        // Resume periodic checks
        startPeriodicCheck();
      }
    };

    // Function to disable auto-scroll
    const disableAutoScroll = () => {
      if (autoScrollEnabled) {
        autoScrollEnabled = false;
        // Stop periodic checks
        if (periodicCheckInterval) {
          clearInterval(periodicCheckInterval);
          periodicCheckInterval = null;
        }
      }
    };

    // Function to start periodic check
    const startPeriodicCheck = () => {
      if (!periodicCheckInterval) {
        periodicCheckInterval = setInterval(() => {
          scrollTocToActive();
        }, 5000); // Increased interval to 5 seconds
      }
    };

    // Handle TOC scrolling
    scrollContainer.addEventListener("scroll", () => {
      isUserScrolling = true;
      disableAutoScroll(); // Disable auto-scroll when user scrolls TOC

      if (scrollTimeout) {
        clearTimeout(scrollTimeout);
      }

      scrollTimeout = setTimeout(() => {
        isUserScrolling = false;
        // Don't automatically re-enable auto-scroll here
        // It will be re-enabled when user interacts with main page
      }, 500);
    });

    // Handle page scrolling
    window.addEventListener("scroll", () => {
      enableAutoScroll(); // Re-enable auto-scroll when user scrolls main page

      if (pageScrollTimeout) {
        clearTimeout(pageScrollTimeout);
      }

      pageScrollTimeout = setTimeout(() => {
        scrollTocToActive();
      }, 100);
    });

    // Handle clicks on main page content
    document.addEventListener("click", (event) => {
      // Only enable auto-scroll if click is not on TOC
      if (!sidebarNav.contains(event.target)) {
        enableAutoScroll();
      }
    });

    // Handle keyboard navigation
    document.addEventListener("keydown", () => {
      enableAutoScroll();
    });

    // Initial scroll to active element
    setTimeout(() => {
      scrollTocToActive();
    }, 1000);

    // Start periodic check
    startPeriodicCheck();
  });
</script>


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://ambersuncreates.com/" itemprop="url">Shawn Hsu</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>For it isn’t by size that you win or fail</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Taipei, Taiwan</span>
        </li>
      

      
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/ambersun1234" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/ambersun1234" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:ambersun1019.shawn@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="ambersun1019.shawn@gmail.com">
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="CS:APP - Representing and Manipulating Information">
    <meta itemprop="description" content="Information Storage相較於直接操作 bits，使用 bytes(8 bits) 會顯得方便得多。以 machine-level 來看待記憶體就會是一連串的 byte 陣列，每個 bytes 都有一個獨立的 id(address)，對於所有可能的 address 稱之為 virtual address space所有關於 compiler, run-time system 如何分配記憶體，都是基於 virtual address space，諸如: 指標操作、結構操作等等。C 語言擁有所謂 type 的資訊，以用於區分各種形態大小(指標要加多少 offset 才能正確取值)，不過在 machine-level 自然是沒有這種資訊的，對於機器而言，這就是一堆的 byte">
    <meta itemprop="datePublished" content="2021-08-14T00:00:00+08:00">
    <meta itemprop="dateModified" content="2024-02-28T00:54:43+08:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://ambersuncreates.com/csapp/csapp-Representing-and-Manipulating-Information/" class="u-url" itemprop="url">CS:APP - Representing and Manipulating Information
</a>
          </h1>
          


  <p class="page__meta">
    

    

    
      
      

      

         

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>

         

      <span class="page__meta-readtime">
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Posted on:
        <time class="dt-published" datetime="2021-08-14">2021-08-14</time>
      </span>

      
           
        
        <span class="page__meta-readtime">
          <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Updated on:
          <time class="dt-published" datetime="2024-02-28">
            2024-02-28
          </time>
        </span>

           

        <span>
          <i class="fas fa-eye" aria-hidden="true"></i>
          Views: <span id="view-field-/csapp/csapp-Representing-and-Manipulating-Information/"> Loading...</span>
        </span>
      
    
  </p>


<script>
  fetch(`https://api.ambersuncreates.com/views?url=/csapp/csapp-Representing-and-Manipulating-Information/`)
    .then(async (response) => {
      if (response.ok) {
        data = await response.json();

        let text = "-";
        if (data.views > 100) {
          text = Intl.NumberFormat('en', { notation: 'compact' }).format(data.views);
        }
        document.getElementById("view-field-/csapp/csapp-Representing-and-Manipulating-Information/").innerHTML = text;
      }
    })
</script>

        </header>
      

      <section class="page__content e-content" itemprop="text" style="margin-top: 2em">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
<li><a href="#information-storage">Information Storage</a></li>
<li><a href="#integer-representations">Integer Representations</a></li>
</ul>

            </nav>

            <br>

            <div class="sidebar__top_down" style="display: flex;">
              <div>
                <nav style="padding: 0 0.5em;">
                  <a href="#site-nav"> <i class="fas fa-angle-double-up fa-2x"></i></a>
                </nav>
              </div>

              <div>
                <nav style="padding: 0 0.5em;">
                  <a href="#footer"> <i class="fas fa-angle-double-down fa-2x"></i></a>
                </nav>
              </div>
            </div>

            
          </aside>
        
        <h1 id="information-storage">Information Storage</h1>
<p>相較於直接操作 bits，使用 bytes(8 bits) 會顯得方便得多。以 machine-level 來看待記憶體就會是一連串的 byte 陣列，每個 bytes 都有一個獨立的 id(address)，對於所有可能的 address 稱之為 virtual address space<br>
所有關於 compiler, run-time system 如何分配記憶體，都是基於 <code class="language-plaintext highlighter-rouge">virtual address space</code>，諸如: 指標操作、結構操作等等。<br>
C 語言擁有所謂 <code class="language-plaintext highlighter-rouge">type</code> 的資訊，以用於區分各種形態大小(指標要加多少 offset 才能正確取值)，不過在 machine-level 自然是沒有這種資訊的，對於機器而言，這就是一堆的 byte</p>

<p>pointer 大小一般為 word size, 而 virtual address 是以 word 做編碼的，若一機器為 <code class="language-plaintext highlighter-rouge">w-bit word size</code>，則最多可以定址 $2^w$ bytes</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>linux&gt; gcc <span class="nt">-m32</span> prog.c
linux&gt; gcc <span class="nt">-m64</span> prog.c
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">-m32</code> 編譯出來的程式可以跑在 <code class="language-plaintext highlighter-rouge">32-bit</code> 以及 <code class="language-plaintext highlighter-rouge">64-bit</code> 電腦上
<code class="language-plaintext highlighter-rouge">-m64</code> 只能跑在 <code class="language-plaintext highlighter-rouge">64-bit</code> 電腦上</p>

<p>對於不同機器，資料格式大小也會不同，比如說: <code class="language-plaintext highlighter-rouge">int</code> 可以為 2, 4 或 8 bytes<br>
為了避免不同機器上有不同的大小，<a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf">ISO C99</a> 制定了一個規則，提供了 <code class="language-plaintext highlighter-rouge">int32_t</code> 保證大小為 4 bytes, <code class="language-plaintext highlighter-rouge">int64_t</code> 為 8 bytes</p>

<p>儘管大多數變數型態都有 <code class="language-plaintext highlighter-rouge">signed</code> 或 <code class="language-plaintext highlighter-rouge">unsigned</code>，那 <code class="language-plaintext highlighter-rouge">char</code> 也是嗎?<br>
在 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=47">C 語言規格書 p.35 §6.2.5</a>中，</p>

<blockquote>
  <p>The three types char, signed char, and unsigned char are collectively called the character types. The implementation shall define char to have the same range, representation, and behavior as either signed char or unsigned char. 35)</p>
</blockquote>

<p>並沒有指定 <code class="language-plaintext highlighter-rouge">char</code> 要 signed 還是 unsigned，一切由 compiler 的實作而定，像是 gcc default 使用 unsigned char，並擁有如 <code class="language-plaintext highlighter-rouge">-funsigned-char</code>, <code class="language-plaintext highlighter-rouge">-fsigned-char</code> 的 compile flag</p>

<p>此外 C 語言也對於關鍵字的排列提供不同的方式，以下四種效果皆相同</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="rouge-code"><pre><span class="kt">unsigned</span> <span class="kt">long</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">int</span>
<span class="kt">long</span> <span class="kt">unsigned</span>
<span class="kt">long</span> <span class="kt">unsigned</span> <span class="kt">int</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>開發者需要自行解決在不同平台的不同變數大小的問題，在 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=47">C 語言規格書 p.33 §6.2.5</a> 僅有規定大小的下界(lower-bound) 並沒有指定上界(upper-bound)</p>

<blockquote>
  <p>An object declared as type _Bool is large enough to store the values 0 and 1.</p>

  <p>A ‘‘plain’’ int object has the natural size suggested by the architecture of the execution environment (large enough to contain any value in the range INT_MIN to INT_MAX as defined in the header <limits.h>).</limits.h></p>
</blockquote>

<p>程式是由很多個 bytes 組成，我們必須考量兩個點</p>

<ul>
  <li>在某個地址上的 object 是甚麼</li>
  <li>要怎麼在記憶體中排列 bytes</li>
</ul>

<p>有些機器對於如何排列 bytes 有不同的意見，以下為兩種不同排列方式<br>
假設 0x0 上有資料 $x_0x_1x_2x_3$</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">little endian</th>
      <th style="text-align: center">$x_3$</th>
      <th style="text-align: center">$x_2$</th>
      <th style="text-align: center">$x_1$</th>
      <th style="text-align: center">$x_0$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">big endian</td>
      <td style="text-align: center">$x_0$</td>
      <td style="text-align: center">$x_1$</td>
      <td style="text-align: center">$x_2$</td>
      <td style="text-align: center">$x_3$</td>
    </tr>
  </tbody>
</table>

<p>有些 IBM, Oracle 機器採用 big endian, 有些則採用 littel endian<br>
對於哪種比較好，其實沒有一定，只要約定好就好<br>
常見需要注意的場合有</p>

<ul>
  <li>網路通訊</li>
  <li>查看 data sequences</li>
</ul>

<p><img src="https://i.imgur.com/AEkrAKJ.png" alt=""><br>
注意到 <code class="language-plaintext highlighter-rouge">int</code> 與 <code class="language-plaintext highlighter-rouge">float</code> 的輸出結果不一致，這是因為他們使用了不同的編碼系統</p>

<p>binary values 是為組成編碼、操作訊息的重要理論基礎<br>
boolean algebra 是由 {0, 1} 組成，並有 $\neg , \lor , \land$ 等操作<br>
C 語言也提供 bitwise 操作，需要注意 logical operator 與 bit operator 的差異，以下以 not 作為舉例</p>

<ul>
  <li>~ 是將所有 bit 反轉</li>
  <li>! 是將數值取 negative(boolean)</li>
</ul>

<p>同時還提供 shift operation，也就是將 bit 往左或右推</p>

<ul>
  <li>往左: 0b1010 <img class="emoji" title=":arrow_right:" alt=":arrow_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/27a1.png" height="20" width="20"> 0b0100</li>
  <li>往右:
    <ul>
      <li>邏輯右移: 0b0101</li>
      <li>算術右移: 0b1101</li>
    </ul>
  </li>
</ul>

<h1 id="integer-representations">Integer Representations</h1>
<p>C 語言可以表示多種的整數，包含: char, short 以及 long。C 語言僅規定各個型態最少需要表達多少範圍，並無界定上界，需要注意的是上界與下界的範圍並不一致</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>int : -32,767 ~ 32,767
long: -2,147,483,647 ~ 2,147,483,647
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>事實上，int 的數值範圍僅需 <code class="language-plaintext highlighter-rouge">2 byte</code> 即可表示，這就要追朔到 16-bit 機器，如今 int 大小，以 gcc 實作來說會是 4 byte</p>

<p>考慮用 bits 表示 int，以 unsigned 來說，最小值會是 0b0000…0000，最大值會是 0b1111…1111<br>
unsigned 二進位表示法有一個很重要的特性，所有 int 數值在 binary 表示法中，都會有 唯一 的表示<br>
如果是 signed int 呢，二補數(Two’s Complement) 就是用來表示負數的。具體的做法就是將 MSB(Most Significant Bit) 賦予負數權重<br>
<img src="https://i.imgur.com/eu1EwVu.png" alt=""><br>
C 語言提供不同符號的數值切換，經由 casting 可以達成，但會不會有甚麼錯誤呢? 考慮以下例子</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre><span class="kt">short</span> <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12345</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">uv</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span><span class="n">v</span><span class="p">;</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"v = %d, uv = %u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">uv</span><span class="p">);</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>結果</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>v  = -12345
uv = 53191
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>需要注意的是，bit 的數值並沒有任何改變，變的是解讀 bit 的方法。<br>
多數 C 語言都是透過這樣子的機制去處理 signed 與 unsigned 之間的轉換</p>

<ul>
  <li>定義 B2U: Bytes to unsigned</li>
  <li>定義 B2T: Bytes to 2’s complement</li>
  <li>定義 T2U: 2’s complement to unsigned</li>
  <li>定義 T2B: 2’s complement to bytes</li>
</ul>

\[T2U =
    \begin{cases}
      x + 2^w, &amp; x &lt; 0 \\
      0, &amp; x \geq 0
    \end{cases}  \\
U2T =
    \begin{cases}
        u, &amp; u \leq TMax_w \\
        u - 2^w, &amp; u &gt; TMax_w
    \end{cases}
\\\]

<p>輸出如下所示</p>

\[T2U(-12345) = 53191 \\
U2T(53191) = -12345 \\
T2U(-1) = 4294967295 \\
U2T(4294967295) = -1\]

<p><img src="https://i.imgur.com/ajbgcnJ.png" alt=""><br>
<img src="https://i.imgur.com/3EcEgJw.png" alt=""></p>

<p>因為 unsigned 的部分不包含 $\leq 0$，2 補數的部分則是橫跨正數與負數<br>
觀察以上圖示可以得到以下結論</p>

\[B2U(T2B(x)) = T2U(x) = B2T + x_{w - 1}2^w \\
U2T(x) = -x_{w - 1}2^w + x\]

<p>儘管 C 語言沒有指定如何表示 signed numbers，大多數系統都採用二補數的方式進行，其中也提供 <code class="language-plaintext highlighter-rouge">casting</code> 機制作為 signed/unsigned 轉換，而方式分為</p>

<ul>
  <li>顯式轉換
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre><span class="kt">int</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">;</span>

<span class="n">tx</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">ux</span><span class="p">;</span>
<span class="n">uy</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">ty</span><span class="p">;</span>
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>隱式轉換
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="rouge-code"><pre><span class="kt">int</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">;</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">ux</span><span class="p">;</span>
<span class="n">uy</span> <span class="o">=</span> <span class="n">ty</span><span class="p">;</span>
</pre></td>
</tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<p>關於 C 語言這種隱式轉換，常常會帶來一些非預期的結果，比如說</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">0u</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>因為是 int 與 unsigned 的比較，所以他會把第一個 -1 轉換成 unsigned，因此其實是</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="mi">4294967295u</span> <span class="o">&lt;</span> <span class="mi">0u</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>因此答案是 <code class="language-plaintext highlighter-rouge">false</code>，神奇吧</p>

<p>而在 printf 方面，可以使用 <code class="language-plaintext highlighter-rouge">%d</code>, <code class="language-plaintext highlighter-rouge">%u</code>, <code class="language-plaintext highlighter-rouge">%x</code> 等表示不同型態數值，不過 printf 不會用 type 相關資訊，因此我們可以用 <code class="language-plaintext highlighter-rouge">int</code> 搭配 <code class="language-plaintext highlighter-rouge">%u</code>，考慮以下</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">2147483648</span><span class="p">;</span>

<span class="n">printf</span><span class="p">(</span><span class="s">"x = %u = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"u = %u = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>x = 4294967295 = -1
u = 2147483648 = -2147483648
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>casting 不僅可以用在同大小，也可以用在不同大小上。轉換到 larger data type 的時候要注意位移，前面提到會有 <code class="language-plaintext highlighter-rouge">邏輯位移</code> 以及 <code class="language-plaintext highlighter-rouge">算術位移</code>。考慮以下程式碼</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="rouge-code"><pre><span class="kt">short</span> <span class="n">sx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12345</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">usx</span> <span class="o">=</span> <span class="n">sx</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="n">ux</span> <span class="o">=</span> <span class="n">usx</span><span class="p">;</span>

<span class="n">printf</span><span class="p">(</span><span class="s">"sx  = %d:</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">sx</span><span class="p">);</span>
<span class="n">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sx</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">));</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"usx = %u:</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">usx</span><span class="p">);</span>
<span class="n">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">usx</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">));</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"x   = %d:</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="n">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"ux  = %u:</span><span class="se">\t</span><span class="s">"</span><span class="p">,</span> <span class="n">ux</span><span class="p">);</span>
<span class="n">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ux</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span><span class="p">));</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="rouge-code"><pre>sx  = -12345: cf c7
usx = 53191:  cf c7
x   = -1234:  ff ff cf c7
ux  = 53191:  00 00 cf c7
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>其中算術位移是為了保證讓負數不會因為右移而導致變成正數<br>
上述例子 x 與 ux 個別展示了算術位移以及邏輯位移</p>

<p>擴增變數大小的方法，綜上所述就是算術以及邏輯位移，不過如果我們想要縮減 number of bits 那會有怎麼樣的結果?<br>
給定 $\overrightarrow{x} = [x_{w-1}, x_{w-2}, …, x_0]$ 縮減到 k bits，實作上將會丟棄最高位元的 <code class="language-plaintext highlighter-rouge">w-k bits</code>，當然其中有可能會出問題，舉例來說，unsigned <img class="emoji" title=":arrow_right:" alt=":arrow_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/27a1.png" height="20" width="20"> signed 就有可能會發生 overflow 的情況<br>
由於 binary 的特性，我們可以得出以下算式</p>

\[B2U_w([x_{w-1}, x_{w-2}, ..., x_0])\ mod\ 2^k = \sum_{i=0}^{k-1}x_i2^i \\
c.f.\ 2^i\ mod\ 2^k = 0, for\ i \geq k\]

<p>對於二補數的轉換也是同樣道理，只不過有東西需要做改變</p>

\[\overrightarrow{x} = [x_{w-1}, x_{w-2}, ..., x_0] \\
\overrightarrow{x}' = [x_{k-1}, x_{k-2}, ..., x_0]\ \text{縮減後的 bit vector}\\
x' = U2T_k(x\ mod\ 2^k)\]

<p>$x\ mod\ 2^k$ 的原因是，二補數最高位元是代表正負號的，如果也將其轉換數值會導致結果錯誤。</p>

<blockquote>
  <p>weight 會從 $2^{k-1}$ 變成 $-2^{k-1}$</p>
</blockquote>

<p>總之，對於二進位的轉換我們可以歸納出以下</p>

\[B2U_k([x_{k-1}, x_{k-2}, ..., x_0]) = B2U_w([w_{k-1}, x_{w-2}, ..., x_0])\ mod 2^k\ \\
B2T_k([x_{k-1}, x_{k-2}, ..., x_0]) = U2T_k(B2U_w([w_{k-1}, x_{w-2}, ..., x_0])\ mod 2^k)\]

<p>由於隱式轉換可能會隱藏錯誤，程式設計師若沒有充分了解數值系統將會導致錯誤。考慮以下例子</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="rouge-code"><pre><span class="kt">float</span> <span class="nf">sum_elements</span><span class="p">(</span><span class="kt">float</span> <span class="n">a</span><span class="p">[],</span> <span class="kt">unsigned</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>假設 length = 0, <code class="language-plaintext highlighter-rouge">i &lt;= length - 1</code> 會發生甚麼事情呢?<br>
可以知道，這是 <code class="language-plaintext highlighter-rouge">int</code> 與 <code class="language-plaintext highlighter-rouge">unsigned</code> 的比較<br>
根據 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=46">C 語言規格書 §6.2.5 第 9 項</a></p>

<blockquote>
  <p>The range of nonnegative values of a signed integer type is a subrange of the corresponding unsigned integer type, and the representation of the same value in each type is the same.31) A computation involving unsigned operands can never overflow, because a result that cannot be represented by the resulting unsigned integer type is reduced modulo the number that is one greater than the largest value that can be represented by the resulting type.</p>
</blockquote>

<p>所以可以得知，0-1 的真實結果會是 <code class="language-plaintext highlighter-rouge">-1 % UINT_MAX+1</code><br>
上述式子會變成 <code class="language-plaintext highlighter-rouge">0(int) &lt;= UINT_MAX(unsigned)</code></p>

<p>根據 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=54">C 語言規格書 §6.3.1.1</a></p>

<blockquote>
  <p>The rank of any unsigned integer type shall equal the rank of the corresponding signed integer type, if any.</p>
</blockquote>

<p>根據 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=57">C 語言規格書 §6.3.1.8</a></p>

<blockquote>
  <p>Otherwise, if the operand that has unsigned integer type has rank greater or equal to the rank of the type of the other operand, then the operand with signed integer type is converted to the type of the operand with unsigned integer type</p>
</blockquote>

<p>綜上所述，int 型態由於跟 unsigned 的 rank 是相同的，又因為 rank 相同所以將 int 轉型為 unsigned<br>
所以最終比較式子會是 <code class="language-plaintext highlighter-rouge">0(unsigned) &lt;= UINT_MAX(unsigned)</code> 條件成立直到 <code class="language-plaintext highlighter-rouge">i = UINT_MAX</code></p>

<p>再考慮以下例子</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="rouge-code"><pre><span class="c1">// prototype of strlen</span>
<span class="kt">size_t</span> <span class="nf">strlen</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">strlonger</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">returen</span> <span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">strlen</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>在某些情況下，上述程式碼會出現不可預期的結果<br>
因為 <code class="language-plaintext highlighter-rouge">strlen</code> 的實作是定義成 size_t，而 size_t 是根據 <code class="language-plaintext highlighter-rouge">typedef</code> 而來的，原型定義在 <a href="http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf#page=266">C 語言規格書 §7.17</a></p>

<blockquote>
  <p>The types are
ptrdiff_t
which is the signed integer type of the result of subtracting two pointers;
size_t
which is the unsigned integer type of the result of the sizeof operator; and wchar_t</p>
</blockquote>

<p>因此 <code class="language-plaintext highlighter-rouge">strlen(s)</code> 與 <code class="language-plaintext highlighter-rouge">strlen(t)</code> 的結果都是 unsigned<br>
若 <code class="language-plaintext highlighter-rouge">strlen(s)</code> 的結果比較小，得出來就會是負數<br>
又因為 unsinged 所以結果會是一個很大的數字<br>
<code class="language-plaintext highlighter-rouge">很大的數字 &gt; 0</code> 其結果為 true<br>
進而導致錯誤</p>

<p>解決的方式是</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="k">return</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>講到 integer arithmetic<br>
假設 x,y 為 postive number，有可能會遇到 <code class="language-plaintext highlighter-rouge">x&lt;y</code> 與 <code class="language-plaintext highlighter-rouge">x-y&lt;0</code> 結果不一樣的時候<br>
假設 x,y 的數字區間範圍為 $2^w$，那麼其結果範圍可能是 $0 \leq x+y \leq 2^{w+1}$<br>
為了要表示這個結果需要 <code class="language-plaintext highlighter-rouge">w+1</code> bits</p>

<p>定義一個符號 $+^u_w$，$0 \leq x, y \leq 2^w$ 而其結果也落在 <code class="language-plaintext highlighter-rouge">w bits</code> 之間<br>
假設使用 4 bit 表示法，x=9, y=12<br>
x+y=21(0b10101) 很明顯超過 4 bit 表示範圍，如果我們捨棄高位元的數值就能得到 9(0b0101)，其值剛好是 <code class="language-plaintext highlighter-rouge">21 mod 16</code><br>
因此代表我們可以做 <code class="language-plaintext highlighter-rouge">mod 運算</code></p>

\[x +^u_w y = \begin{cases}
      x + y, &amp; x+y&lt;2^w &amp; Normal \\
      x + y - 2^w, &amp; 2^w \leq x + y \lt 2^{w+1} &amp; Overflow
    \end{cases}\]

<p>在 C 語言裡面，overflow 並不被視為錯誤的一種，甚至有時候我們會希望藉由此種機制用以檢測是否有 overflow 這種情況發生</p>

<p>那麼要如何檢測 overflow 呢? 給定 $s = x +^u_w y$<br>
僅需考慮 $x + y \geq x$ 或 $x + y \geq y$ 與否即可<br>
回顧上述例子， $9 +^u_w 12 = 5$ <img class="emoji" title=":arrow_right:" alt=":arrow_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/27a1.png" height="20" width="20"> $5 &lt; 9$</p>

<ul>
  <li>如果沒有 overflow <img class="emoji" title=":arrow_right:" alt=":arrow_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/27a1.png" height="20" width="20"> $s \geq x$</li>
  <li>如果有 overflow <img class="emoji" title=":arrow_right:" alt=":arrow_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/27a1.png" height="20" width="20"> $s = x + y - 2^w$</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre><span class="c1">// return 1: overflow</span>
<span class="c1">// return 0: no overflow</span>
<span class="kt">int</span> <span class="nf">uadd_ok</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>因為 two’s complment 的加法與 unsigned 的加法邏輯一樣，因此我們可以改寫成 $x +^t_w y = U2T_w(T2U_w(x) +^u_w T2U_w(y))$<br>
先使用 unsigned 加法做完之後再轉換到 two’s complement 即可</p>

\[\begin{align}
x +^t_w y &amp;= U2T_w(T2U_w(x) +^u_w T2U_w(y)) \\
          &amp;= U2T_w[(x_{w-1}2^w + x + y_{w-1}2^w + y mod\ 2^w] \\
          &amp;= U2T_w[(x + y)\ mod\ 2^w]
\end{align}\]

<p>T2U 可以改寫成 $x_{w-1}2^w + x$ 是因為只要讓最高位元採計並加上原本後面的資料就可以轉成 unsigned 了<br>
考慮以下測驗題</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">tadd_ok</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">sum</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>  <span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">sum</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>  <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></td>
</tr></tbody></table></code></pre></div></div>

<p>這個 overflow 檢查的實作是錯的，原因是 two’s complment addition 是一個 <a href="https://en.wikipedia.org/wiki/Abelian_group">abliean group</a> 所以 <code class="language-plaintext highlighter-rouge">(sum - x)</code> 其實跟 <code class="language-plaintext highlighter-rouge">(x + y -x)</code> 一樣，也就是說不管有沒有 overflow ，上述的結果都會是 y</p>

<blockquote>
  <p><a href="https://stackoverflow.com/questions/25963827/check-of-overflow-in-signed-addition-and-abelian-groups">Check of overflow in signed addition and abelian groups</a></p>
</blockquote>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#c" class="page__taxonomy-item p-category" rel="tag">c</a><span class="sep">, </span>
    
      <a href="/tags/#operating-system" class="page__taxonomy-item p-category" rel="tag">operating system</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#csapp" class="page__taxonomy-item p-category" rel="tag">csapp</a>
    
    </span>
  </p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=CS%3AAPP+-+Representing+and+Manipulating+Information%20https%3A%2F%2Fambersuncreates.com%2Fcsapp%2Fcsapp-Representing-and-Manipulating-Information%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fambersuncreates.com%2Fcsapp%2Fcsapp-Representing-and-Manipulating-Information%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fambersuncreates.com%2Fcsapp%2Fcsapp-Representing-and-Manipulating-Information%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/csapp/csapp-A-Tour-of-Computer-Systems/" class="pagination--pager" title="CS:APP - A Tour of Computer Systems
">Previous</a>
    
    
      <a href="/git/git-hook/" class="pagination--pager" title="Git 進階使用 - Git Hook
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/database/database-filter/" rel="permalink">資料庫 - 機率型資料結構 Bloom Filter 在 Cache 中的應用
</a>
      
    </h2>
    


  <p class="page__meta">
    

    

    
      
      

      

         

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>

         

      <span class="page__meta-readtime">
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Posted on:
        <time class="dt-published" datetime="2026-01-19">2026-01-19</time>
      </span>

      
           
        
        <span class="page__meta-readtime">
          <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Updated on:
          <time class="dt-published" datetime="2024-02-28">
            2024-02-28
          </time>
        </span>

           

        <span>
          <i class="fas fa-eye" aria-hidden="true"></i>
          Views: <span id="view-field-/database/database-filter/"> Loading...</span>
        </span>
      
    
  </p>


<script>
  fetch(`https://api.ambersuncreates.com/views?url=/database/database-filter/`)
    .then(async (response) => {
      if (response.ok) {
        data = await response.json();

        let text = "-";
        if (data.views > 100) {
          text = Intl.NumberFormat('en', { notation: 'compact' }).format(data.views);
        }
        document.getElementById("view-field-/database/database-filter/").innerHTML = text;
      }
    })
</script>

    <p class="archive__item-excerpt" itemprop="description">Cache Issues
就像我們在 資料庫 - Cache Strategies 與常見的 Solutions | Shawn Hsu 當中提到的
如果碰到惡意攻擊，查詢不在 cache 也不在 database 裡面的資料，那麼所有的請求都會直接到 database，然後又會直接被打爆
所以其實在這種狀況底下...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/random/golang-gc/" rel="permalink">多開 Goroutine 的效能瓶頸以及 Garbage Collection 對其的影響
</a>
      
    </h2>
    


  <p class="page__meta">
    

    

    
      
      

      

         

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>

         

      <span class="page__meta-readtime">
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Posted on:
        <time class="dt-published" datetime="2026-01-15">2026-01-15</time>
      </span>

      
           
        
        <span class="page__meta-readtime">
          <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Updated on:
          <time class="dt-published" datetime="2024-02-28">
            2024-02-28
          </time>
        </span>

           

        <span>
          <i class="fas fa-eye" aria-hidden="true"></i>
          Views: <span id="view-field-/random/golang-gc/"> Loading...</span>
        </span>
      
    
  </p>


<script>
  fetch(`https://api.ambersuncreates.com/views?url=/random/golang-gc/`)
    .then(async (response) => {
      if (response.ok) {
        data = await response.json();

        let text = "-";
        if (data.views > 100) {
          text = Intl.NumberFormat('en', { notation: 'compact' }).format(data.views);
        }
        document.getElementById("view-field-/random/golang-gc/").innerHTML = text;
      }
    })
</script>

    <p class="archive__item-excerpt" itemprop="description">Preface
Goroutine 作為 Golang 的一大特色
其輕量且快速的特性，使得其的開銷相比 process 以及 thread 要來的低上許多
因此人們往往會將 Goroutine 用在非同步的操作上，比如說 I/O 或者是 CPU-bound 的操作
用以達到併發的效果

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/kubernetes/kubernetes-workloads/" rel="permalink">Kubernetes 從零開始 - Pod 高級抽象 Workload Resources
</a>
      
    </h2>
    


  <p class="page__meta">
    

    

    
      
      

      

         

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>

         

      <span class="page__meta-readtime">
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Posted on:
        <time class="dt-published" datetime="2025-11-23">2025-11-23</time>
      </span>

      
           
        
        <span class="page__meta-readtime">
          <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Updated on:
          <time class="dt-published" datetime="2024-02-28">
            2024-02-28
          </time>
        </span>

           

        <span>
          <i class="fas fa-eye" aria-hidden="true"></i>
          Views: <span id="view-field-/kubernetes/kubernetes-workloads/"> Loading...</span>
        </span>
      
    
  </p>


<script>
  fetch(`https://api.ambersuncreates.com/views?url=/kubernetes/kubernetes-workloads/`)
    .then(async (response) => {
      if (response.ok) {
        data = await response.json();

        let text = "-";
        if (data.views > 100) {
          text = Intl.NumberFormat('en', { notation: 'compact' }).format(data.views);
        }
        document.getElementById("view-field-/kubernetes/kubernetes-workloads/").innerHTML = text;
      }
    })
</script>

    <p class="archive__item-excerpt" itemprop="description">High Level Abstraction
之前提到 Pod 是 Kubernetes 當中部署的最小單位，因為其設計關係(比如說容易被 reschedule 以及被刪除等等)，是比較不適合直接操作的
因此 Kubernetes 提供了更高層次的抽象，讓我們可以更方便的管理 Pod
本文將會走過一遍這些更高階的...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/kubernetes/kubernetes-volume/" rel="permalink">Kubernetes 從零開始 - 你的 Volume 到底 Mount 到哪裡去了？
</a>
      
    </h2>
    


  <p class="page__meta">
    

    

    
      
      

      

         

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>

         

      <span class="page__meta-readtime">
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Posted on:
        <time class="dt-published" datetime="2025-11-13">2025-11-13</time>
      </span>

      
           
        
        <span class="page__meta-readtime">
          <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>Updated on:
          <time class="dt-published" datetime="2024-02-28">
            2024-02-28
          </time>
        </span>

           

        <span>
          <i class="fas fa-eye" aria-hidden="true"></i>
          Views: <span id="view-field-/kubernetes/kubernetes-volume/"> Loading...</span>
        </span>
      
    
  </p>


<script>
  fetch(`https://api.ambersuncreates.com/views?url=/kubernetes/kubernetes-volume/`)
    .then(async (response) => {
      if (response.ok) {
        data = await response.json();

        let text = "-";
        if (data.views > 100) {
          text = Intl.NumberFormat('en', { notation: 'compact' }).format(data.views);
        }
        document.getElementById("view-field-/kubernetes/kubernetes-volume/").innerHTML = text;
      }
    })
</script>

    <p class="archive__item-excerpt" itemprop="description">Introduction to Kubernetes Volume
從 Docker 的年代開始，掛載 host 的檔案系統不是什麼新鮮事
而 mount 的方式也很直覺，直接指定 host 的檔案路徑，你就能夠在 container 裡面存取相關的資料
到了 Kubernetes，也是有一樣的概念，但是 mou...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

<script type="text/javascript">
  let viewHeight = window. innerHeight;
  let codeblocks = document.getElementsByClassName("highlight");

  Array.from(codeblocks).forEach(value => {
      if (value.scrollHeight > viewHeight) {
          value.setAttribute("style", "height:100vh;overflow-y:auto;");
      }
  })
</script>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/ambersun1234" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2026 Shawn Hsu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q9EYCKB89S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q9EYCKB89S', { 'anonymize_ip': false});
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://ambersuncreates.com/csapp/csapp-Representing-and-Manipulating-Information/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/csapp/csapp-Representing-and-Manipulating-Information"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-ambersun1234-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
    },
    "HTML-CSS": {
      scale: 80
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 




  </body>
</html>
